

FROM rust:1.76.0 AS base 

WORKDIR /app

RUN cargo install cargo-watch

ENV CARGO_PKG_NAME=$CARGO_PKG_NAME
ENV RUN_MODE=$RUN_MODE
ENV PORT=$PORT

COPY . .

EXPOSE $PORT
ENV CARGO_TARGET_DIR=$CARGO_TARGET_DIR

CMD ["cargo", "watch", "-x", "run"]